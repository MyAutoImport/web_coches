<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>My Auto Import ‚Äî Veh√≠culos premium desde Alemania</title>
  <meta name="description" content="Importamos veh√≠culos premium desde Alemania con garant√≠a completa y la m√°xima calidad. Gesti√≥n integral, financiaci√≥n y entrega r√°pida.">
  <meta name="robots" content="index,follow">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="My Auto Import">
  <meta property="og:title" content="Veh√≠culos premium desde Alemania ‚Äî My Auto Import">
  <meta property="og:description" content="Importamos veh√≠culos premium desde Alemania con garant√≠a completa y la m√°xima calidad.">
  <meta property="og:image" content="/og-image.jpg">
  <meta property="og:url" content="https://myautoimport.es/">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Favicons / PWA -->
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="alternate icon" href="/favicon.ico" sizes="any">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest?v=2">
  <meta name="theme-color" content="#0f172a">

  <!-- Auth (tu widget) -->
  <script src="/api/public-config.js"></script>
  <script type="module" src="/js/auth-widget.js"></script>

  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <!-- CSS (primero tu base, luego el tema Emergent) -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/emergent.css">
</head>
<body>
  <!-- Header (lo dejo fuera del #em-app para que pueda ser global si quieres) -->
  <header class="site-header" role="banner">
    <div class="nav-wrap">
      <a class="brand" href="/" aria-label="Inicio">
        <span class="brand-logo" aria-hidden="true">üöó</span>
        <span>Autolimport Iberia</span>
      </a>

      <button id="nav-toggle" class="nav-toggle" aria-label="Abrir men√∫" aria-controls="mobile-drawer" aria-expanded="false">
        <span class="bar"></span><span class="bar"></span><span class="bar"></span>
      </button>

      <nav class="nav-desktop" aria-label="Men√∫ principal">
        <a href="/" class="active">Inicio</a>
        <a href="/stock.html">Stock</a>
        <div id="user-nav" class="user-nav"></div>
        <a href="/#contacto" class="btn primary">Contactar</a>
      </nav>
    </div>

    <!-- Drawer m√≥vil -->
    <div id="mobile-drawer" class="drawer" role="dialog" aria-modal="true" aria-label="Men√∫">
      <div class="drawer-inner">
        <div class="drawer-top">
          <span class="drawer-title">Men√∫</span>
          <button class="drawer-close" aria-label="Cerrar men√∫">‚úï</button>
        </div>
        <nav class="drawer-nav" aria-label="Navegaci√≥n m√≥vil">
          <a href="/" class="drawer-link active">Inicio</a>
          <a href="/stock.html" class="drawer-link">Stock</a>
          <a href="/#contacto" class="drawer-link btn primary" style="text-align:center;">Contactar</a>
        </nav>
        <div id="user-nav-mobile" class="drawer-user" aria-label="Estado de sesi√≥n"></div>
        <div style="height:calc(12px + env(safe-area-inset-bottom,0px))"></div>
      </div>
      <button class="drawer-backdrop" tabindex="-1" aria-hidden="true"></button>
    </div>
  </header>

  <!-- ========= A PARTIR DE AQU√ç TODO EL DISE√ëO NUEVO VA ENVUELTO ========= -->
  <div id="em-app" role="main" aria-label="Landing My Auto Import">
    <main>
      <!-- HERO emer -->
      <section class="hero">
        <div class="hero-inner">
          <div class="hero-copy">
            <h1>Veh√≠culos Premium<br>desde Alemania</h1>
            <p class="subtitle">
              Importamos directamente desde Alemania los mejores veh√≠culos
              con garant√≠a completa y la m√°xima calidad alemana.
            </p>
            <div class="hero-cta">
              <a class="btn primary lg" href="/stock.html">Ver Stock Disponible</a>
              <a class="btn outline lg" href="/#contacto">Contactar Ahora</a>
            </div>

            <div class="stats">
              <div class="stat">
                <div class="stat-num">15+</div>
                <div class="stat-label">A√±os de experiencia</div>
              </div>
              <div class="stat">
                <div class="stat-num">500+</div>
                <div class="stat-label">Veh√≠culos importados</div>
              </div>
              <div class="stat">
                <div class="stat-num">100%</div>
                <div class="stat-label">Garant√≠a completa</div>
              </div>
            </div>
          </div>

          <figure class="hero-media">
            <img src="/img/hero-bmw.jpg" alt="BMW en carretera, importaci√≥n premium" loading="eager" decoding="async" width="1280" height="900">
          </figure>
        </div>
      </section>

      <!-- Por qu√© elegirnos -->
      <section class="features">
        <h2>¬øPor qu√© elegirnos?</h2>
        <p class="section-sub">La confianza de nuestros clientes nos avala</p>

        <div class="feature-grid">
          <article class="card">
            <div class="icon">üõ°Ô∏è</div>
            <h3>Garant√≠a Completa</h3>
            <p>Todos nuestros veh√≠culos cuentan con garant√≠a europea oficial.</p>
          </article>
          <article class="card">
            <div class="icon">üîé</div>
            <h3>Inspecci√≥n Total</h3>
            <p>Informe completo, historial y verificaci√≥n t√©cnica antes de la compra.</p>
          </article>
          <article class="card">
            <div class="icon">‚ö°</div>
            <h3>Proceso R√°pido</h3>
            <p>Gesti√≥n integral y entrega √°gil directamente desde Alemania.</p>
          </article>
          <article class="card">
            <div class="icon">‚≠ê</div>
            <h3>Calidad Premium</h3>
            <p>Solo veh√≠culos de origen contrastado y mantenimiento al d√≠a.</p>
          </article>
        </div>
      </section>

      <!-- Contacto -->
      <section id="contacto" class="contact">
        <div class="contact-inner">
          <h2>¬øBuscas un veh√≠culo espec√≠fico?</h2>
          <p class="section-sub">Cu√©ntanos y te ayudamos a encontrarlo.</p>

          <form id="contact-form" class="contact-form" novalidate>
            <div class="grid">
              <div class="col">
                <label for="nombre">Nombre</label>
                <input type="text" id="nombre" name="nombre" placeholder="Nombre" required minlength="2" maxlength="100">
              </div>
              <div class="col">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Email" required maxlength="254">
              </div>
            </div>
            <label for="mensaje">Mensaje</label>
            <textarea id="mensaje" name="mensaje" placeholder="Qu√© necesitas‚Ä¶" rows="4" required minlength="10" maxlength="2000"></textarea>

            <div class="form-actions">
              <button class="btn primary" type="submit">Enviar</button>
              <p id="form-status" aria-live="polite"></p>
            </div>
          </form>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="footer-inner">
        <div class="col">
          <div class="brand mini">
            <span class="brand-logo">üöó</span> Autolimport Iberia
          </div>
          <p>Especialistas en importaci√≥n de veh√≠culos premium desde Alemania.</p>
        </div>
        <div class="col">
          <h4>Servicios</h4>
          <ul>
            <li>Importaci√≥n desde Alemania</li>
            <li>Gesti√≥n de documentaci√≥n</li>
            <li>Inspecci√≥n t√©cnica</li>
            <li>Financiaci√≥n</li>
          </ul>
        </div>
        <div class="col">
          <h4>Contacto</h4>
          <ul>
            <li>Madrid, Espa√±a</li>
            <li><a href="mailto:info@myautoimport.es">info@myautoimport.es</a></li>
          </ul>
        </div>
      </div>
      <div class="copy">¬© <span id="year"></span> My Auto Import. Todos los derechos reservados.</div>
    </footer>
  </div>
  <!-- ======================== FIN #em-app ======================== -->

  <!-- Utils + validaci√≥n que ya usas -->
  <script src="/js/utils.js" defer></script>

  <script>
    // A√±o en footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Env√≠o del formulario
    document.getElementById('contact-form')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const fd = new FormData(e.currentTarget);
      const payload = {
        nombre: (fd.get('nombre')||'').toString().trim(),
        email: (fd.get('email')||'').toString().trim(),
        mensaje: (fd.get('mensaje')||'').toString().trim(),
        page_url: location.href,
        user_agent: navigator.userAgent
      };

      const statusEl = document.getElementById('form-status');
      if (!Validator.required(payload.nombre, 2)) { statusEl.textContent = 'Nombre inv√°lido.'; return; }
      if (!Validator.email(payload.email)) { statusEl.textContent = 'Email inv√°lido.'; return; }
      if (!Validator.required(payload.mensaje, 10)) { statusEl.textContent = 'Mensaje demasiado corto.'; return; }

      statusEl.textContent = 'Enviando‚Ä¶';
      try {
        const res = await fetch('/api/notify-lead', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });
        if (!res.ok) throw 0;
        statusEl.textContent = '¬°Gracias! Te contactaremos en breve.';
        e.currentTarget.reset();
        notify?.success?.('Lead enviado correctamente');
      } catch {
        statusEl.textContent = 'Error enviando lead.';
        notify?.error?.('No se pudo enviar el formulario');
      }
    });

    // Drawer accesible (igual que en stock/car)
    (() => {
      const toggleBtn = document.getElementById('nav-toggle');
      const drawer    = document.getElementById('mobile-drawer');
      const closeBtn  = drawer?.querySelector('.drawer-close');
      if (!toggleBtn || !drawer) return;

      const focusableSel = ['a[href]','button:not([disabled])','input','select','textarea','[tabindex]:not([tabindex="-1"])'].join(',');
      let lastFocused = null;

      const open = () => {
        lastFocused = document.activeElement;
        drawer.classList.add('open');
        document.body.classList.add('nav-open');
        toggleBtn.setAttribute('aria-expanded','true');
        drawer.querySelector(focusableSel)?.focus({preventScroll:true});
      };
      const close = () => {
        drawer.classList.remove('open');
        document.body.classList.remove('nav-open');
        toggleBtn.setAttribute('aria-expanded','false');
        lastFocused?.focus?.({preventScroll:true});
      };
      const isOpen = () => drawer.classList.contains('open');

      toggleBtn.addEventListener('click', () => isOpen() ? close() : open(), { passive:true });
      closeBtn?.addEventListener('click', close, { passive:true });

      window.addEventListener('keydown', (e) => {
        if (!isOpen()) return;
        if (e.key === 'Escape') { e.preventDefault(); close(); }
        if (e.key === 'Tab') {
          const f = [...drawer.querySelectorAll(focusableSel)];
          if (!f.length) return;
          const first = f[0], last = f[f.length-1];
          if (e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
          else if (!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
        }
      });

      const reset = () => { drawer.classList.remove('open'); document.body.classList.remove('nav-open'); toggleBtn.setAttribute('aria-expanded','false'); };
      window.addEventListener('pageshow', reset);
      window.addEventListener('pagehide', reset);
      window.addEventListener('beforeunload', reset);
      document.addEventListener('visibilitychange', ()=>{ if(document.hidden) reset(); });
    })();
  </script>

  <script src="/js/emergent.js" defer></script>

  <!-- Anal√≠tica (Cloudflare) -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token":"6bacc6c3cd2f482793c643c5fe8df0b7"}'></script>
</body>
</html>
